/* SKIPPED_TEST
	: Test query is too long (max 4000 characters)
	: Query references a non-simple refset. Likely need to refactor this query

insert into qa_result (runid, assertionuuid, concept_id, details, component_id, table_name)
	select 
	'<RUNID>',
	'<ASSERTIONUUID>',
	null,
	'005 All uses of a substance (within the same UoM heirarchy) reference the same strength unit',
	null,
	null
ROM (SELECT substanceunit.destinationid AS substanceid, COUNT(*)           FROM (SELECT DISTINCT                        hasAuBoss.destinationid AS destinationid,                        CONVERT(                           CONCAT(                              '',                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'area unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'volume unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'mass unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'type of international unit')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'biological unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'microbiological culture unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'descriptive unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'hour')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = '16 hours')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = '24 hours')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'time unit of measure')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'type of pharmacopoeial unit')),                              ISDESCENDENTOF_CR(                                 numUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'radiation activity unit of measure')),                              denUnits.destinationid IS NULL,                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'area unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'volume unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'mass unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'type of international unit')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'biological unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'microbiological culture unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'descriptive unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'hour')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = '16 hours')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = '24 hours')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term = 'time unit of measure')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'type of pharmacopoeial unit')),                              ISDESCENDENTOF_CR(                                 denUnits.destinationid,                                 (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE     moduleid = 900062011000036108                                         AND term =                                                'radiation activity unit of measure'))) USING UTF8)                           AS hierarchyKey                   FROM <PROSPECTIVE>.relationship_<SNAPSHOT> hasAuBoss                        JOIN <PROSPECTIVE>.ccsRefset_<SNAPSHOT> strength                           ON     strength.referencedcomponentid =                                     hasAuBoss.id                              AND strength.active = 1                              AND strength.refsetid =                                     (SELECT DISTINCT conceptid                                        FROM <PROSPECTIVE>.description_<SNAPSHOT>                                       WHERE term = 'strength reference set')                        JOIN <PROSPECTIVE>.relationship_<SNAPSHOT> numUnits                           ON     strength.value1 = numUnits.sourceid                              AND numUnits.typeid =                                     (SELECT DISTINCT conceptid                                        FROM <PROSPECTIVE>.description_<SNAPSHOT>                                       WHERE term = 'has numerator units')                              AND numUnits.active = 1                        LEFT OUTER JOIN <PROSPECTIVE>.relationship_<SNAPSHOT> denUnits                           ON     strength.value1 = denUnits.sourceid                              AND denUnits.typeid =                                     (SELECT DISTINCT conceptid                                        FROM <PROSPECTIVE>.description_<SNAPSHOT>                                       WHERE term = 'has denominator units')                              AND denUnits.active = 1                  WHERE     hasAuBoss.typeid =                               (SELECT DISTINCT conceptid                                  FROM <PROSPECTIVE>.description_<SNAPSHOT>                                 WHERE term = 'has Australian BoSS')                        AND hasAuBoss.active = 1) AS substanceunit         GROUP BY substanceunit.destinationid, substanceunit.hierarchyKey         HAVING COUNT(*) > 1) AS multiunitstrength        JOIN <PROSPECTIVE>.relationship_<SNAPSHOT> bossRel           ON     bossRel.typeid = (SELECT DISTINCT conceptid                                      FROM <PROSPECTIVE>.description_<SNAPSHOT>                                     WHERE term = 'has Australian BoSS')              AND bossRel.active = 1              AND bossRel.destinationid = multiunitstrength.substanceid        JOIN <PROSPECTIVE>.ccsRefset_<SNAPSHOT> str           ON     str.referencedcomponentid = bossRel.id              AND str.active = 1              AND str.refsetid = (SELECT DISTINCT conceptid                                    FROM <PROSPECTIVE>.description_<SNAPSHOT>                                   WHERE term = 'strength reference set') ORDER BY multiunitstrength.substanceid;
*/

